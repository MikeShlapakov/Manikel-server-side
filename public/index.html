<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div id="createuser" style="background-color: rgb(208, 173, 173); width:fit-content; margin-bottom: 30px;">
        <b>Create User</b><br>
            displayName:<input id="createuser1"><br>
            username:   <input id="createuser2"><br>
            password:   <input id="createuser3"><br>
            pfp:        <input id="createuser4"><br>
            <button onclick="createUser()">create user</button><br>
    </div>



    <div id="getusers" style="background-color: rgb(208, 173, 173); width:fit-content; margin-bottom: 30px;">
        <b>Get users</b><br>
        <textarea id="getusers1"></textarea>
        <button onclick="getUsers()">get users</button><br>
    </div>



    <div id="createpost" style="background-color: rgb(208, 173, 173); width:fit-content; margin-bottom: 30px;">
        <b>Create Post</b><br>
            author id:   <input id="createpost3"><br>
            content:     <input id="createpost1"><br>
            image:       <input id="createpost2"><br>
            <!-- date:        <input id="createpost4"><br> -->
            <!-- likes:       <input id="createpost5"><br> -->
            <button onclick="createPost()">create post</button><br>
    </div>


    
    <div id="getallposts" style="background-color: rgb(208, 173, 173); width:fit-content; margin-bottom: 30px;">
        <b>Get All Posts</b><br>
        <textarea id="getallposts1"></textarea>
        <button onclick="getAllPosts()">get posts</button><br>
    </div> 



    <div id="getposts" style="background-color: rgb(208, 173, 173); width:fit-content; margin-bottom: 30px;">
        <b>Get User Posts</b><br>
        user id:   <input id="getposts1"><br>
        <textarea id="getposts2"></textarea>
        <button onclick="getUserPosts()">get posts</button><br>
    </div>  



    <div id="createcomment" style="background-color: rgb(208, 173, 173); width:fit-content; margin-bottom: 30px;">
        <b>Create Comment</b><br>
            parent post id:     <input id="createcomment1"><br>
            author id:          <input id="createcomment2"><br>
            content:            <input id="createcomment3"><br>
            <button onclick="createCommenta()">create comment</button><br>
    </div>



    <div id="getcomments" style="background-color: rgb(208, 173, 173); width:fit-content; margin-bottom: 30px;">
        <b>Get Comments</b><br>
        parent post id:         <input id="getcomments1"><br>
        <textarea></textarea>
        
        <button onclick="getPostComments()">get comments</button><br>
    </div> 



    <div id="sendrequest" style="background-color: rgb(208, 173, 173); width:fit-content; margin-bottom: 30px;">
        <b>Send friend request</b><br>
        from id:  <input id="send1"><br>
        to id:    <input id="send2"><br>
        <button onclick="sendFriendRequest()">send friend request</button><br>
    </div>  



    <div id="acceptrequest" style="background-color: rgb(208, 173, 173); width:fit-content; margin-bottom: 30px;">
        <b>Accept friend request</b><br>
        from id:  <input id="accept1"><br>
        to id:    <input id="accept2"><br>
        <button onclick="acceptFriendRequest()">accept friend request</button><br>
    </div>  



    <script>
        async function createUser() {
            const user = await fetch('http://localhost:3000/api/users', {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    displayName: document.getElementById('createuser1').value,
                    username: document.getElementById('createuser2').value,
                    password: document.getElementById('createuser3').value,
                    pfp: document.getElementById('createuser4').value
                })
            }).then(data => data.json())
        }



        async function getUsers() {
            const users = await fetch('http://localhost:3000/api/users', {
                method: "GET",
                headers: {
                    "Content-Type": "application/json",
                }
            }).then(data => data.json())

            console.log(users);
            document.getElementById('getusers1').innerText = JSON.stringify(users);
        }



        async function createPost() {
            const post = await fetch('http://localhost:3000/api/users/'+ document.getElementById('createpost3').value +'/posts', {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    content: document.getElementById('createpost1').value,
                    image: document.getElementById('createpost2').value,
                    date: new Date()
                })
            }).then(data => data.json())
        }



        async function getAllPosts() {
            const posts = await fetch('http://localhost:3000/api/posts', {
                method: "GET",
                headers: {
                    "Content-Type": "application/json",
                }
            }).then(data => data.json())

            console.log(posts);
            document.getElementById('getallposts1').innerText = JSON.stringify(posts);
        }



        async function getUserPosts() {
            const users = await fetch('http://localhost:3000/api/users/' + document.getElementById('getposts1').value +'/posts' , {
                method: "GET",
                headers: {
                    "Content-Type": "application/json",
                },
            }).then(data => data.json())

            console.log(users);
            document.getElementById('getposts2').innerText = JSON.stringify(users);
        }



        async function createCommenta() {
            // first param is passed through the link
            const comment = await fetch('http://localhost:3000/api/posts/'+ document.getElementById('createcomment1').value, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    authorId: document.getElementById('createcomment2').value,
                    content: document.getElementById('createcomment3').value,
                })
            }).then(data => data.json())
        }



        async function getPostComments() {
            const users = await fetch('http://localhost:3000/api/posts/' + document.getElementById('getcomments1').value , {
                method: "GET",
                headers: {
                    "Content-Type": "application/json",
                },
            }).then(data => data.json())

            // console.log(users);
            document.getElementById('getcomments2').innerText = JSON.stringify(users);
        }



        async function sendFriendRequest() {
            const users = await fetch('http://localhost:3000/api/users/' + document.getElementById('send1').value + '/friends',
             {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    fid: document.getElementById('send2').value,
                })
            }).then(data => data.json())
        }



        async function acceptFriendRequest() {
            console.log("1")
            const users = await fetch('http://localhost:3000/api/users/' + document.getElementById('accept1').value + '/friends/' + document.getElementById('accept2').value, {
                method: "PATCH",
                headers: {
                    "Content-Type": "application/json",
                }
            }).then(data => data.json())
            console.log("2")
        }

    </script>
</body>

</html>